<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.teamup.demo.userManage.mapper.UserMapper">

    <sql id="sel">select * from public.student</sql>
    <select id="getAllStu" resultType="com.teamup.demo.userManage.entity.Student">
        <include refid="sel"/>
    </select>

    <select id="findUserByUser" parameterType="String" resultType="com.teamup.demo.userManage.entity.Student">
        select * from public.${table} where "user" = #{user}
    </select>

    <insert id="addUser">
        insert into public.${table} ("user",pwd,mail) values (#{user.user},#{user.pwd},#{user.mail})
    </insert>

    <update id="updatePwdByUser" >
        update public.${table} set pwd = #{pwd} where "user" = #{user}
    </update>

    <insert id="addCertification" parameterType="com.teamup.demo.userManage.entity.Certification">
        insert into public.certification ("user", sex, id, school, name, time, isAgree) values
           (#{user}, #{sex}, #{id}, #{school}, #{name}, #{time}, #{isAgree})
    </insert>

    <select id="getCertificationByType" parameterType="int"
            resultType="com.teamup.demo.userManage.entity.Certification">
        select * from public.certification where isAgree = false and type = #{type} order by time
    </select>
    
    <update id="agreeCertification" parameterType="List">
        update public.certification set isAgree = true where "user" in
        <foreach item="item" collection="list" separator="," open="(" close=")" index="">
            item
        </foreach>
    </update>
</mapper>
